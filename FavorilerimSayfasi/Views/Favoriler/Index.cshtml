@model List<FavorilerimSayfasi.Models.FavoriKlasor>
@{
    ViewData["Title"] = "Favorilerim";
}

<div class="container-fluid py-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h3 mb-0 text-dark">
                    <i class="bi bi-heart-fill text-danger me-2"></i>Favorilerim
                </h2>
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="refreshFavoriler()">
                        <i class="bi bi-arrow-clockwise me-1"></i>Yenile
                    </button>
                </div>
            </div>

            <!-- Klasör Grid -->
            <div class="row g-4">
                @foreach (var klasor in Model)
                {
                    <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
                        <div class="card klasor-card h-100 shadow-sm border-0" 
                             style="background: linear-gradient(135deg, @klasor.RenkKodu 0%, @(klasor.RenkKodu)dd 100%);">
                            <div class="card-body p-0">
                                <!-- Klasör Header -->
                                <div class="klasor-header p-3 d-flex justify-content-between align-items-start">
                                    <div class="klasor-icon">
                                        <i class="bi @klasor.IkonAdi text-white fs-1"></i>
                                    </div>
                                    <div class="klasor-actions opacity-0">
                                        <button class="btn btn-sm btn-light btn-action me-1" 
                                                onclick="klasorDuzenle(@klasor.Id, '@klasor.KlasorAdi')" 
                                                title="Düzenle">
                                            <i class="bi bi-pencil"></i>
                                        </button>
                                        <button class="btn btn-sm btn-light btn-action" 
                                                onclick="klasorSil(@klasor.Id)" 
                                                title="Sil">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Klasör Body -->
                                <div class="klasor-body p-3 pt-0">
                                    <h5 class="klasor-adi text-white fw-bold mb-2">@klasor.KlasorAdi</h5>
                                    <div class="klasor-bilgi d-flex justify-content-between align-items-center">
                                        <span class="badge bg-white bg-opacity-25 text-white">
                                            <i class="bi bi-heart-fill me-1"></i>@klasor.FavoriSayisi
                                        </span>
                                        <small class="klasor-tarih text-white text-opacity-75">
                                            @klasor.OlusturmaTarihi.ToString("dd.MM.yyyy")
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }

                <!-- Yeni Klasör Ekleme Kartı -->
                <div class="col-xl-3 col-lg-4 col-md-6 col-sm-12">
                    <div class="card yeni-klasor-card h-100 shadow-sm border-2 border-dashed border-secondary bg-light">
                        <div class="card-body d-flex flex-column justify-content-center align-items-center p-4">
                            <div class="yeni-klasor-content text-center">
                                <div class="yeni-klasor-icon mb-3">
                                    <i class="bi bi-plus-circle-fill text-secondary" style="font-size: 3rem;"></i>
                                </div>
                                <h6 class="yeni-klasor-text text-secondary mb-3">Yeni Klasör Oluştur</h6>
                                <button type="button" class="btn btn-outline-secondary" 
                                        data-bs-toggle="modal" data-bs-target="#modalYeniKlasor">
                                    <i class="bi bi-folder-plus me-2"></i>Klasör Ekle
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Boş Durum -->
            @if (!Model.Any())
            {
                <div class="text-center py-5">
                    <div class="empty-state-icon mb-3">
                        <i class="bi bi-heart text-muted" style="font-size: 4rem;"></i>
                    </div>
                    <h5 class="text-muted">Henüz favori klasörünüz yok</h5>
                    <p class="text-muted">İlk favori klasörünüzü oluşturmak için yukarıdaki butonu kullanın.</p>
                </div>
            }
        </div>
    </div>
</div>

<!-- Yeni Klasör Modal -->
<div class="modal fade" id="modalYeniKlasor" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-folder-plus me-2"></i>Yeni Klasör Oluştur
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formYeniKlasor">
                    <div class="mb-3">
                        <label for="klasorAdi" class="form-label">Klasör Adı</label>
                        <input type="text" class="form-control" id="klasorAdi" 
                               placeholder="Klasör adını girin" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                <button type="button" class="btn btn-primary" onclick="yeniKlasorOlustur()">
                    <i class="bi bi-check-lg me-2"></i>Oluştur
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Klasör Düzenleme Modal -->
<div class="modal fade" id="modalKlasorDuzenle" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-pencil me-2"></i>Klasör Adını Düzenle
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="formKlasorDuzenle">
                    <input type="hidden" id="duzenleKlasorId">
                    <div class="mb-3">
                        <label for="duzenleKlasorAdi" class="form-label">Klasör Adı</label>
                        <input type="text" class="form-control" id="duzenleKlasorAdi" 
                               placeholder="Yeni klasör adını girin" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                <button type="button" class="btn btn-warning" onclick="klasorAdiGuncelle()">
                    <i class="bi bi-check-lg me-2"></i>Güncelle
                </button>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .klasor-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .klasor-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
        }
        
        .klasor-card:hover .klasor-actions {
            opacity: 1 !important;
        }
        
        .klasor-actions {
            transition: opacity 0.3s ease;
        }
        
        .btn-action {
            transition: all 0.2s ease;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-action:hover {
            transform: scale(1.1);
        }
        
        .yeni-klasor-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .yeni-klasor-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1) !important;
            border-color: #6c757d !important;
        }
        
        .klasor-icon i {
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        
        .klasor-adi {
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .badge {
            font-size: 0.8rem;
            padding: 0.5rem 0.75rem;
        }
        
        .klasor-tarih {
            font-size: 0.75rem;
        }
    </style>
}

@section Scripts {
    <script>
        // Klasör kartlarına hover efekti
        document.querySelectorAll('.klasor-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.querySelector('.klasor-actions').classList.remove('opacity-0');
            });
            
            card.addEventListener('mouseleave', function() {
                this.querySelector('.klasor-actions').classList.add('opacity-0');
            });
        });

        // Yeni klasör oluştur
        function yeniKlasorOlustur() {
            const klasorAdi = document.getElementById('klasorAdi').value.trim();
            if (!klasorAdi) {
                alert('Lütfen klasör adı girin');
                return;
            }
            
            // Burada AJAX ile backend'e gönderilecek
            console.log('Yeni klasör:', klasorAdi);
            
            // Modal'ı kapat
            bootstrap.Modal.getInstance(document.getElementById('modalYeniKlasor')).hide();
            document.getElementById('klasorAdi').value = '';
        }

        // Klasör düzenle
        function klasorDuzenle(id, ad) {
            document.getElementById('duzenleKlasorId').value = id;
            document.getElementById('duzenleKlasorAdi').value = ad;
            new bootstrap.Modal(document.getElementById('modalKlasorDuzenle')).show();
        }

        // Klasör adı güncelle
        function klasorAdiGuncelle() {
            const id = document.getElementById('duzenleKlasorId').value;
            const yeniAd = document.getElementById('duzenleKlasorAdi').value.trim();
            
            if (!yeniAd) {
                alert('Lütfen yeni klasör adı girin');
                return;
            }
            
            // Burada AJAX ile backend'e gönderilecek
            console.log('Klasör güncelle:', id, yeniAd);
            
            // Modal'ı kapat
            bootstrap.Modal.getInstance(document.getElementById('modalKlasorDuzenle')).hide();
        }

        // Klasör sil
        function klasorSil(id) {
            if (confirm('Bu klasörü silmek istediğinizden emin misiniz?')) {
                // Burada AJAX ile backend'e gönderilecek
                console.log('Klasör sil:', id);
            }
        }

        // Favorileri yenile
        function refreshFavoriler() {
            location.reload();
        }
    </script>
}
